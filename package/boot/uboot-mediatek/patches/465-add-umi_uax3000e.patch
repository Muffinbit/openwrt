From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Muffinbit <github.com/muffinbit>
Date: Wed, 8 Oct 2025 23:15:53 +0800
Subject: [PATCH] uboot: add support for UMI UAX3000E

---
 arch/arm/dts/mt7981b-umi-uax3000e.dts | 119 ++++++++++++++++++++++++++
 configs/umi_uax3000e_defconfig        |  14 ++++
 2 files changed, 133 insertions(+)
 create mode 100644 arch/arm/dts/mt7981b-umi-uax3000e.dts
 create mode 100644 configs/umi_uax3000e_defconfig

diff --git a/arch/arm/dts/mt7981b-umi-uax3000e.dts b/arch/arm/dts/mt7981b-umi-uax3000e.dts
new file mode 100644
index 0000000000..c2b2d8d4d6
--- /dev/null
+++ b/arch/arm/dts/mt7981b-umi-uax3000e.dts
@@ -0,0 +1,119 @@
+// SPDX-License-Identifier: GPL-2.0-or-later OR MIT
+/*
+ * Copyright (C) 2025 UMI
+ */
+
+/dts-v1/;
+#include "mt7981.dtsi"
+
+/ {
+	model = "UMI UAX3000E";
+	compatible = "umi,uax3000e", "mediatek,mt7981";
+
+	aliases {
+		serial0 = &uart0;
+	};
+
+	chosen {
+		stdout-path = "serial0:115200n8";
+	};
+
+	memory@40000000 {
+		device_type = "memory";
+		reg = <0x40000000 0x40000000>;
+	};
+};
+
+&uart0 {
+	status = "okay";
+};
+
+รฐ {
+	status = "okay";
+
+	gmac0: mac@0 {
+		compatible = "mediatek,eth-mac";
+		reg = <0>;
+		phy-mode = "2500base-x";
+
+		fixed-link {
+			speed = <2500>;
+			full-duplex;
+			pause;
+		};
+	};
+
+	gmac1: mac@1 {
+		compatible = "mediatek,eth-mac";
+		reg = <1>;
+		phy-mode = "gmii";
+		phy-handle = <&int_gbe_phy>;
+	};
+};
+
+&mdio_bus {
+	int_gbe_phy: ethernet-phy@0 {
+		compatible = "ethernet-phy-id03a2.9461";
+		reg = <0>;
+		reset-gpios = <&pio 39 GPIO_ACTIVE_HIGH>;
+		reset-assert-us = <10000>;
+		reset-deassert-us = <20000>;
+	};
+
+	switch: switch@1f {
+		compatible = "mediatek,mt7531";
+		reg = <31>;
+		reset-gpios = <&pio 39 GPIO_ACTIVE_HIGH>;
+		interrupt-controller;
+		#interrupt-cells = <1>;
+		interrupt-parent = <&pio>;
+		interrupts = <38 IRQ_TYPE_LEVEL_HIGH>;
+	};
+};
+
+&switch {
+	ports {
+		#address-cells = <1>;
+		#size-cells = <0>;
+
+		port@0 {
+			reg = <0>;
+			label = "lan1";
+		};
+
+		port@1 {
+			reg = <1>;
+			label = "lan2";
+		};
+
+		port@2 {
+			reg = <2>;
+			label = "lan3";
+		};
+
+		port@6 {
+			reg = <6>;
+			ethernet = <&gmac0>;
+			phy-mode = "2500base-x";
+
+			fixed-link {
+				speed = <2500>;
+				full-duplex;
+				pause;
+			};
+		};
+	};
+};
+
+&mmc0 {
+	status = "okay";
+};
+
+&watchdog {
+	status = "okay";
+};
+
+&xhci {
+	status = "okay";
+};
+
diff --git a/configs/umi_uax3000e_defconfig b/configs/umi_uax3000e_defconfig
new file mode 100644
index 0000000000..c9d1b0f4c3
--- /dev/null
+++ b/configs/umi_uax3000e_defconfig
@@ -0,0 +1,14 @@
+CONFIG_ARM=y
+CONFIG_POSITION_INDEPENDENT=y
+CONFIG_ARCH_MEDIATEK=y
+CONFIG_TARGET_MT7981=y
+CONFIG_SYS_TEXT_BASE=0x41e00000
+CONFIG_SYS_MALLOC_F_LEN=0x4000
+CONFIG_MT7981_DDR3_1024MB=y
+CONFIG_DEFAULT_DEVICE_TREE="mt7981b-umi-uax3000e"
+CONFIG_DEFAULT_ENV_FILE="board/mediatek/mt7981/env.txt"
+CONFIG_DEFAULT_FDT_FILE="mt7981b-umi-uax3000e"
+CONFIG_DEBUG_UART=y
+CONFIG_AUTOBOOT_KEYED=y
+CONFIG_AUTOBOOT_MENU_SHOW=y
+CONFIG_BOARD_LATE_INIT=y
